<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h4 class="modal-title" id="myModalLabel">
        {# 模态框标题#}
        {% block modal-title %}
        {% endblock %}
    </h4>
</div>
<div class="modal-body">
    <form class="form-horizontal" id="form-modal" role="form">
        {% csrf_token %}
        {% block modal-form-content %}
        {% endblock %}
    </form>

</div>
<div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
    <button type="button" class="btn btn-primary" id="btn-submit">
        {% block btn-submit %}
            提交
        {% endblock %}
    </button>
</div>

<script>

{#    csrf表单#}
    var csrftoken = getCookie('csrftoken');

    $.ajaxSetup({
        crossDomain: false, // obviates need for sameOrigin test
        beforeSend: function (xhr, settings) {
            if (!csrfSafeMethod(settings.type)) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });

    $("#btn-submit").bind("click", function () {
        var form = new FormData($("#form-modal")[0]);
        $.ajax({
            url: "{% block modal-url %}{% endblock %}",
            type: "post",
            data: form,
            processData: false,
            contentType : false,
            success:function(r){
                alert(r);
                window.location.href = "{% block modal-redirect %}{% endblock %}";
            }
        });
    });
</script>